#--*******--#
#  Monitor  #
#--*******--#

env = LIBVA_DRIVER_NAME,nvidia
env = XDG_SESSION_TYPE,wayland
env = GBM_BACKEND,nvidia-drm
env = __GLX_VENDOR_LIBRARY_NAME,nvidia
env = WLR_NO_HARDWARE_CURSORS,1
env = HYPRCURSOR_THEME,rose-pine-hyprcursor
monitor=,preferred,auto,1,mirror,HDMI-A-1

debug {
  disable_logs = false
  enable_stdout_logs = true
}

plugin {
    hyprtrails {
        color = rgba(ffaa00ff)
    }
}

#--*******--#
#  StartUp  #
#--*******--#
#TODO:manage this by systemd
exec-once=~/.config/bgscripts/swaybg.sh
exec-once=fcitx5
exec-once=wl-paste --watch cliphist store
exec-once=waybar
exec-once=systemctl start --user foot-server
#NOTE:https://discourse.nixos.org/t/programs-program-enable-doesnt-auto-start-waybar-and-nm-applet-with-hyprland-and-sddm/32768/3
#https://github.com/nix-community/home-manager/issues/3599
exec-once=wlsunset -l 39.9 -L 116.3
exec-once=mako

#--*****--#
#  Input  #
#--*****--#
input {
    kb_layout=
    kb_variant=
    kb_model=
    kb_options=caps:swapescape
    kb_rules=

    # follow_mouse=1

    touchpad {
        natural_scroll=yes
        scroll_factor=0.18
        # tap-and-drag = true
    }
}
#--******--#
#  Layout  #
#--******--#

dwindle {
    no_gaps_when_only = false
    force_split = 2
    special_scale_factor = 0.8
    split_width_multiplier = 1.0
    use_active_for_splits = true
    smart_split = true
    # permanent_direction_override = true
    pseudotile = yes
    preserve_split = yes
}

master {
    new_is_master = true
    new_on_top = true
    no_gaps_when_only = false
    orientation = right
    special_scale_factor = 0.8
}

# group {
#     # col.border_active=rgb(6611cc)
#     # col.border_inactive=rgb(6666cc)
#     # groupbar{
#     #     col.active = rgb(6666cc)
#     # }
# }
#--*******--#
#  General  #
#--*******--#
general {
    sensitivity=1.3 # for mouse cursor
    gaps_in=5
    gaps_out=15
    border_size=2
    col.inactive_border=rgb(313244)
    col.active_border=rgb(6666cc)
    resize_on_border=true

    cursor_inactive_timeout=2
    apply_sens_to_raw=0 # whether to apply the sensitivity to raw input (e.g. used by games where you aim using your mouse)
    layout = master
    # layout = dwindle

}
#--**********--#
#  Decoration  #
#--**********--#
decoration {
    rounding=2
    active_opacity = 1.0
    inactive_opacity = 1.0
    blur {
        enabled = true
        size = 30
        passes = 1
    }
    drop_shadow = true
    shadow_range = 20
    shadow_render_power = 4
    shadow_ignore_window = true
    dim_inactive = true
    dim_strength = 0.3
}

animations {
    enabled=1
    # bezier=idk,0.14,0.33,0.14,0.83
    bezier = myBezier, 0.05, 0.9, 0.1, 1.05
    animation = windows, 1, 7, myBezier
    # animation=windows,1,3,idk
    animation=border,1,10,default
    animation=fade,1,10,default
    animation=workspaces,1,6,default
}


gestures {
    workspace_swipe=true
    workspace_swipe_fingers = 3
    workspace_swipe_distance = 250
    workspace_swipe_invert = true
    workspace_swipe_min_speed_to_force = 30
    workspace_swipe_cancel_ratio = 0.5
    workspace_swipe_create_new = false
}

misc {
    disable_hyprland_logo = true
    enable_swallow = true
    swallow_regex = ^(Alacritty|bilibili|kitty|footclient|foot)$
    focus_on_activate = true
}
# windowrule=float,android-studio
windowrule=float,termfloat
windowrule=move 25%-,termfloat
windowrule=size 960 540,termfloat
windowrule=rounding 20,termfloat
windowrule=float,polkit-kde-authentication-agent-1
windowrule=opacity 0.95 0.8,footclient
windowrule=tile,netease-cloud-music
windowrule=float,title:jojo
windowrule=fullscreen,title:"Playwright Inspector"
windowrule=fullscreen,mpv
# windowrule=fullscreen,neovide
#windowrule=pseudo,abc
#windowrule=monitor 0,xyz

#--*******--#
#  Mainmod  #
#--*******--#
$mainmod = SUPER
# bind=$mainmod,W,exec,alacritty
# bind=$mainmod,Return,exec,alacritty --class termfloat
bind=$mainmod,W,exec,footclient
bind=$mainmod,Return,exec,alacritty --class termfloat
bind=$mainmod,F,exec,firefox
bind=$mainmod,P,exec,grim -g "$(slurp)"
bind=$mainmod,R,exec,fuzzel
bind=$mainmod SHIFT,R,exec,rofi -show run
bind=$mainmod,A,fullscreen
bind=$mainmod,Q,killactive
# bind=$mainmod,P,pin
bind=$mainmod,V,exec,cliphist list | rofi -dmenu| cliphist decode | wl-copy
bind=$mainmod,C,exec,notify-send "$(trans --translator bing --target-lang zh_CN $(wl-paste))"
# bind=ALT,TAB,layoutmsg,cyclenext
bind = $mainmod, h, movefocus, l
bind = $mainmod, l, movefocus, r
bind = $mainmod, k, movefocus, u
bind = $mainmod, j, movefocus, d
bind = ALT, Tab, cyclenext,
bind = ALT, Tab, bringactivetotop,

bind=$mainmod,S,submap,resize

# will start a submap called "resize"
submap=resize

# sets repeatable binds for resizing the active window
binde=,l,resizeactive,10 0
binde=,h,resizeactive,-10 0
binde=,k,resizeactive,0 -10
binde=,j,resizeactive,0 10

# use reset to go back to the global submap
bind=,escape,submap,reset 

# will reset the submap, meaning end the current one and return to the global one
submap=reset

# will switch to a submap called move
bind=$mainmod,M,submap,move

# will start a submap called "move"
submap=move

# sets repeatable binds for moving the active window
bind=,l,movewindow,r
bind=,h,movewindow,l
bind=,k,movewindow,u
bind=,j,movewindow,d

# use reset to go back to the global submap
bind=,escape,submap,reset 

# will reset the submap, meaning end the current one and return to the global one
submap=reset
#--************--#
#  Main + Shift  #
#--************--#
bind=$mainmod SHIFT,Q,exit
bind=$mainmod SHIFT,F,togglefloating
bind=$mainmod SHIFT,P,exec,hyprlock
bind=$mainmod SHIFT,H,workspace,-1
bind=$mainmod SHIFT,L,workspace,+1
bind=$mainmod SHIFT,G,togglegroup
bind=$mainmod SHIFT,K,changegroupactive,f
bind=$mainmod SHIFT,J,changegroupactive,b
#--************--#
#  CTRL + SHIFT  #
#--************--#
bind=CTRL SHIFT,h,resizeactive,-20 0
bind=CTRL SHIFT,l,resizeactive,20 0
bind=CTRL SHIFT,j,resizeactive,0 20
bind=CTRL SHIFT,k,resizeactive,0 -20
#--*********--#
#  Workspace  #
#--*********--#
bind=$mainmod,1,workspace,1
bind=$mainmod,2,workspace,2
bind=$mainmod,3,workspace,3
bind=$mainmod,4,workspace,4
bind=$mainmod,5,workspace,5
bind=$mainmod,6,workspace,6
bind=$mainmod,7,workspace,7
bind=$mainmod,8,workspace,8
bind=$mainmod,9,workspace,9
bind=$mainmod,0,workspace,10
bind=CTRL,1,movetoworkspace,1
bind=CTRL,2,movetoworkspace,2
bind=CTRL,3,movetoworkspace,3
bind=CTRL,4,movetoworkspace,4
bind=CTRL,5,movetoworkspace,5
bind=CTRL,6,movetoworkspace,6
bind=CTRL,7,movetoworkspace,7
bind=CTRL,8,movetoworkspace,8
bind=CTRL,9,movetoworkspace,9
bind=CTRL,0,movetoworkspace,10



# bind=SUPER,mouse_down,workspace,e+1
# bind=SUPER,mouse_up,workspace,e-1





# example window rules
# for windows named/classed as abc and xyz
#windowrule=move 69 420,abc
#windowrule=size 420 69,abc
#windowrule=tile,xyz
#windowrule=float,abc
#windowrule=pseudo,abc
#windowrule=monitor 0,xyz
